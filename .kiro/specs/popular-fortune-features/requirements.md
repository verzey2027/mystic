# Requirements Document: Popular Fortune Features

## Introduction

This document specifies requirements for six new fortune-telling features to expand REFFORTUNE's divination offerings beyond the existing Tarot, Spirit Card, Numerology, and Daily Card features. These features target popular Thai fortune-telling practices including daily horoscopes, love compatibility, Chinese zodiac, specialized readings, and name numerology.

The features must integrate seamlessly with the existing credit-based monetization system, maintain the fast interaction time (<5 seconds), and follow the established pattern of deterministic baseline interpretations enhanced by AI-generated insights.

## Glossary

- **System**: The REFFORTUNE web application
- **User**: A person accessing the fortune-telling services
- **Reading**: A complete fortune-telling result including interpretation and guidance
- **Zodiac_Sign**: One of the 12 Western astrological signs (Aries through Pisces)
- **Chinese_Zodiac**: One of the 12 animal signs in the Chinese zodiac system
- **Time_Period**: A duration for horoscope readings (daily, weekly, monthly)
- **Compatibility_Score**: A numerical value representing relationship compatibility (0-100)
- **Credit**: A unit of currency in the monetization system
- **Paywall**: A mechanism that restricts access based on credit availability
- **Interpretation_Engine**: The component that generates fortune-telling interpretations
- **Baseline_Interpretation**: A deterministic, pre-defined interpretation template
- **AI_Enhancement**: Additional personalized content generated by Gemini API
- **Thai_Name**: A Thai first name and surname combination
- **Name_Score**: A numerological value derived from name analysis
- **Birth_Date**: A date of birth in DD/MM/YYYY format
- **Reading_History**: A collection of past readings stored for the user

## Requirements

### Requirement 1: Daily Horoscope by Zodiac Sign

**User Story:** As a user, I want to view my daily horoscope based on my zodiac sign, so that I can receive guidance for the current day.

#### Acceptance Criteria

1. THE System SHALL support all 12 Western zodiac signs (Aries, Taurus, Gemini, Cancer, Leo, Virgo, Libra, Scorpio, Sagittarius, Capricorn, Aquarius, Pisces)
2. WHEN a user selects a zodiac sign, THE System SHALL display the horoscope for the current date
3. WHEN generating a daily horoscope, THE Interpretation_Engine SHALL combine a Baseline_Interpretation with AI_Enhancement
4. THE System SHALL generate horoscope content covering love, career, finance, and health aspects
5. WHEN the date changes, THE System SHALL generate new horoscope content for all zodiac signs
6. THE System SHALL complete horoscope generation and display within 5 seconds
7. THE System SHALL display horoscope content in Thai language with conversational tone
8. WHEN a user views a daily horoscope, THE System SHALL save it to Reading_History

### Requirement 2: Extended Period Horoscopes

**User Story:** As a user, I want to view weekly and monthly horoscopes, so that I can plan for longer time periods.

#### Acceptance Criteria

1. THE System SHALL support three Time_Period options: daily, weekly, and monthly
2. WHEN a user selects weekly horoscope, THE System SHALL generate predictions for the current week (Monday to Sunday)
3. WHEN a user selects monthly horoscope, THE System SHALL generate predictions for the current calendar month
4. WHEN generating extended period horoscopes, THE Interpretation_Engine SHALL provide broader guidance appropriate to the time span
5. THE System SHALL clearly display the date range covered by each horoscope reading
6. WHEN switching between time periods, THE System SHALL maintain the selected Zodiac_Sign

### Requirement 3: Love Compatibility Analysis

**User Story:** As a user, I want to check love compatibility between two people based on birth dates, so that I can understand relationship dynamics.

#### Acceptance Criteria

1. THE System SHALL accept two Birth_Date inputs for compatibility analysis
2. WHEN two birth dates are provided, THE System SHALL calculate a Compatibility_Score between 0 and 100
3. THE System SHALL derive zodiac signs from the provided birth dates automatically
4. WHEN generating compatibility analysis, THE Interpretation_Engine SHALL provide insights on relationship strengths and challenges
5. THE System SHALL display compatibility results in categories: overall compatibility, communication, emotional connection, and long-term potential
6. THE System SHALL generate deterministic Compatibility_Score using consistent calculation rules
7. WHEN a compatibility reading is generated, THE System SHALL save both birth dates and results to Reading_History

### Requirement 4: Chinese Zodiac Fortune

**User Story:** As a user, I want to view fortune predictions based on my Chinese zodiac animal, so that I can receive guidance from the Chinese astrological system.

#### Acceptance Criteria

1. THE System SHALL support all 12 Chinese_Zodiac animals (Rat, Ox, Tiger, Rabbit, Dragon, Snake, Horse, Goat, Monkey, Rooster, Dog, Pig)
2. WHEN a user provides a birth year, THE System SHALL calculate the correct Chinese_Zodiac sign
3. THE System SHALL support fortune readings for current year, current month, and current day
4. WHEN generating Chinese zodiac fortune, THE Interpretation_Engine SHALL incorporate traditional Chinese astrology concepts
5. THE System SHALL provide guidance on lucky colors, lucky numbers, and auspicious directions
6. THE System SHALL display content in Thai language while preserving Chinese zodiac terminology

### Requirement 5: Specialized Domain Readings

**User Story:** As a user, I want to request fortune readings focused on specific life areas, so that I can receive targeted guidance for my concerns.

#### Acceptance Criteria

1. THE System SHALL support specialized readings for two domains: finance/career and love/relationships
2. WHEN a user selects finance/career domain, THE System SHALL generate predictions focused on work opportunities, income, and professional growth
3. WHEN a user selects love/relationships domain, THE System SHALL generate predictions focused on romantic prospects, relationship harmony, and emotional wellbeing
4. THE System SHALL accept Zodiac_Sign as input for specialized readings
5. WHEN generating specialized readings, THE Interpretation_Engine SHALL provide actionable advice specific to the chosen domain
6. THE System SHALL support time period selection (daily, weekly, monthly) for specialized readings

### Requirement 6: Name Numerology Analysis

**User Story:** As a user, I want to analyze my Thai name using numerology, so that I can understand the influence of my name on my life path.

#### Acceptance Criteria

1. THE System SHALL accept Thai_Name input consisting of first name and surname
2. WHEN a Thai name is provided, THE System SHALL calculate a Name_Score using Thai numerology rules
3. THE System SHALL convert Thai characters to numerical values according to established Thai numerology mappings
4. WHEN calculating Name_Score, THE System SHALL analyze both first name and surname separately and combined
5. THE System SHALL provide interpretation of personality traits, strengths, weaknesses, and life path based on Name_Score
6. THE System SHALL validate that input contains valid Thai characters
7. WHEN invalid characters are detected, THE System SHALL display an error message and request valid Thai name input

### Requirement 7: Monetization Integration

**User Story:** As a system administrator, I want new fortune features to integrate with the existing credit system, so that monetization remains consistent across all features.

#### Acceptance Criteria

1. WHEN a user accesses any new fortune feature, THE Paywall SHALL evaluate credit requirements
2. THE System SHALL define credit costs for each feature type (daily horoscope: 1 credit, weekly: 2 credits, monthly: 3 credits, compatibility: 2 credits, Chinese zodiac: 1 credit, name numerology: 2 credits)
3. WHEN a user has insufficient credits, THE Paywall SHALL display a credit purchase prompt
4. WHEN a user completes a reading, THE System SHALL deduct the appropriate number of credits
5. THE System SHALL allow first-time users to access one free reading per feature type
6. WHEN tracking free readings, THE System SHALL use local storage to maintain state

### Requirement 8: Reading History and Library Integration

**User Story:** As a user, I want to save and review my past fortune readings, so that I can track predictions and reflect on guidance over time.

#### Acceptance Criteria

1. WHEN a reading is completed, THE System SHALL save it to Reading_History with timestamp and feature type
2. THE System SHALL store readings in local storage with a maximum of 50 readings per user
3. WHEN Reading_History exceeds 50 entries, THE System SHALL remove the oldest reading
4. THE System SHALL provide a library view displaying all saved readings organized by feature type
5. WHEN a user selects a saved reading, THE System SHALL display the complete original reading without generating new content
6. THE System SHALL allow users to delete individual readings from Reading_History
7. WHEN displaying saved readings, THE System SHALL show the date, feature type, and a preview of the interpretation

### Requirement 9: User Interface and Navigation

**User Story:** As a user, I want intuitive navigation between fortune features, so that I can easily explore different divination methods.

#### Acceptance Criteria

1. THE System SHALL provide a feature selection interface displaying all available fortune types with icons and descriptions
2. WHEN a user is on any fortune feature page, THE System SHALL display a navigation menu to access other features
3. THE System SHALL maintain consistent UI patterns across all fortune features (input forms, result displays, action buttons)
4. THE System SHALL display a floating action button (FAB) with LINE add CTA on all fortune feature pages
5. WHEN a user completes a reading, THE System SHALL offer options to: view another reading, share results, or return to feature selection
6. THE System SHALL use Thai language for all UI text with clear, conversational tone

### Requirement 10: Performance and Reliability

**User Story:** As a user, I want fortune readings to load quickly and reliably, so that I have a smooth experience.

#### Acceptance Criteria

1. THE System SHALL complete all reading generation and display within 5 seconds from user input submission
2. WHEN the Gemini API is unavailable, THE System SHALL fall back to Baseline_Interpretation only
3. THE System SHALL cache daily horoscope content for each zodiac sign to reduce API calls
4. WHEN cached content exists for the current date, THE System SHALL serve cached content instead of generating new content
5. THE System SHALL invalidate horoscope cache when the date changes
6. WHEN an error occurs during reading generation, THE System SHALL display a user-friendly error message in Thai
7. THE System SHALL log errors to enable debugging without exposing technical details to users

### Requirement 11: AI Integration and Content Quality

**User Story:** As a system administrator, I want AI-generated content to be relevant and high-quality, so that users receive valuable guidance.

#### Acceptance Criteria

1. WHEN calling the Gemini API, THE System SHALL provide context including feature type, zodiac sign, and time period
2. THE System SHALL use the gemini-2.0-flash model for all AI enhancements
3. WHEN generating AI content, THE System SHALL request responses in Thai language with conversational tone
4. THE System SHALL validate that AI responses are non-empty and contain at least 100 Thai characters
5. WHEN AI response validation fails, THE System SHALL retry once before falling back to Baseline_Interpretation
6. THE System SHALL combine Baseline_Interpretation and AI_Enhancement in a structured format with clear sections
7. THE System SHALL include confidence indicators showing which parts are deterministic vs AI-generated

### Requirement 12: Data Privacy and Storage

**User Story:** As a user, I want my personal information and reading history to be stored securely, so that my privacy is protected.

#### Acceptance Criteria

1. THE System SHALL store all user data in browser local storage only (no server-side storage)
2. WHEN storing Birth_Date or Thai_Name, THE System SHALL not transmit this data to external services except Gemini API for interpretation
3. THE System SHALL allow users to clear all stored data through a settings interface
4. WHEN a user clears data, THE System SHALL remove all Reading_History, cached readings, and personal information
5. THE System SHALL not use cookies for tracking user behavior
6. THE System SHALL display a privacy notice explaining data storage practices on first use of each feature

