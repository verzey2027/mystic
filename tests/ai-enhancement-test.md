# การทดสอบการปรับปรุงระบบ AI ให้เจาะลึกและครบถ้วน

## วัตถุประสงค์
ทดสอบว่า AI ใช้แหล่งข้อมูลใหม่ที่ปรับปรุงแล้ว (enhanced prompts, cultural context, validation) หรือไม่

## วันที่ทดสอบ
17 กุมภาพันธ์ 2026

---

## Test Case 1: ทดสอบความยาวและความครบถ้วน

### วิธีทดสอบ
1. เปิดหน้า `/tarot/pick?count=3`
2. เลือกไพ่ 3 ใบ (Past-Present-Future)
3. ใส่คำถาม: "งานของฉันจะเป็นอย่างไรในอีก 3 เดือนข้างหน้า"
4. ดูผลลัพธ์

### สิ่งที่ต้องตรวจสอบ (Checklist)
- [ ] **Summary มีความยาว 3-5 บรรทัด** (ไม่ใช่แค่ 2 บรรทัด)
- [ ] Summary ครอบคลุม: ธีมหลัก + พลังงานโดยรวม + ทิศทางที่ชัดเจน
- [ ] **CardStructure มีความยาวมากกว่า 300 ตัวอักษรไทย**
- [ ] แต่ละไพ่มี `meaning` ยาว 3-4 ประโยค (ไม่ใช่แค่ 1-2 ประโยค)

### ตัวอย่างที่ถูกต้อง (Enhanced)
```
Summary: "ภาพรวมพลังงานบอกว่าคุณกำลังอยู่ในช่วงเปลี่ยนผ่านสำคัญ จากอดีตที่มีความไม่แน่นอน 
สู่ปัจจุบันที่ต้องตัดสินใจอย่างมีสติ และอนาคตที่เต็มไปด้วยโอกาสใหม่ หากคุณใช้บทเรียนจากอดีต
มาตัดสินใจในปัจจุบัน จะเห็นการเปลี่ยนแปลงในทางบวกภายใน 2-3 เดือน"
```

### ตัวอย่างที่ไม่ถูกต้อง (Old)
```
Summary: "งานของคุณมีแนวโน้มดี ควรมีสติและวางแผน"
```

---

## Test Case 2: ทดสอบมิติทางจิตวิทยาและพลังงาน

### วิธีทดสอบ
ดูในส่วน `cards` ของ JSON response

### สิ่งที่ต้องตรวจสอบ (Checklist)
- [ ] มีฟิลด์ `psychologicalLayer` ในแต่ละไพ่
- [ ] มีฟิลด์ `energyPattern` ในแต่ละไพ่
- [ ] `psychologicalLayer` อธิบายความรู้สึก/ความเชื่อ/รูปแบบความคิด
- [ ] `energyPattern` อธิบายพลังงานที่ไหล/ถูกขัดขวาง/สะสมตัว

### ตัวอย่างที่ถูกต้อง
```json
{
  "position": "ปัจจุบัน",
  "card": "The Hermit",
  "psychologicalLayer": "ไพ่นี้สะท้อนความต้องการความสงบและการหาคำตอบจากภายใน คุณอาจรู้สึกว่าต้องการเวลาคนเดียวเพื่อคิดทบทวน",
  "energyPattern": "พลังงานกำลังหดตัวเข้าสู่ภายใน รอเวลาที่เหมาะสมก่อนจะขยายตัวออกไป"
}
```

---

## Test Case 3: ทดสอบข้อคิดเชิงลึก (Deeper Insight)

### สิ่งที่ต้องตรวจสอบ (Checklist)
- [ ] มีฟิลด์ `deeperInsight` ใน JSON response
- [ ] `deeperInsight` มีความยาว 2-3 ประโยค
- [ ] ชี้ให้เห็นบทเรียนสำคัญ หรือรูปแบบที่ซ้ำ หรือการเติบโตทางจิตวิญญาณ

### ตัวอย่างที่ถูกต้อง
```
"deeperInsight": "รูปแบบที่ไพ่ชุดนี้ชี้ให้เห็นคือการเรียนรู้ที่จะไว้วางใจตัวเอง แทนที่จะรอความเห็นชอบจากคนอื่น สถานการณ์นี้มาเพื่อสอนให้คุณกล้าตัดสินใจด้วยตัวเองมากขึ้น"
```

---

## Test Case 4: ทดสอบคำแนะนำที่ปฏิบัติได้ (Actionable Steps)

### สิ่งที่ต้องตรวจสอบ (Checklist)
- [ ] `actions` มี 3 ขั้นตอน (ทันที/ระยะสั้น/ระยะยาว)
- [ ] แต่ละขั้นตอนระบุ: สิ่งที่ต้องทำ + เหตุผล + กรอบเวลา
- [ ] มีฟิลด์ `timeframe` ที่เฉพาะเจาะจง

### ตัวอย่างที่ถูกต้อง
```json
{
  "actions": [
    "ขั้นตอนที่ 1: จดบันทึกความคิดและความรู้สึกเกี่ยวกับงานทุกวัน (ภายใน 3 วัน) เพื่อเห็นรูปแบบที่ชัดเจน",
    "ขั้นตอนที่ 2: คุยกับหัวหน้าหรือเพื่อนร่วมงานเกี่ยวกับทิศทางงาน (ภายใน 1-2 สัปดาห์)",
    "ขั้นตอนที่ 3: สร้างนิสัยการเรียนรู้สิ่งใหม่ๆ อย่างสม่ำเสมอเพื่อพัฒนาทักษะ"
  ],
  "timeframe": "ภายใน 2-3 เดือน จะเห็นการเปลี่ยนแปลงในทางบวก หากทำตามขั้นตอนอย่างสม่ำเสมอ"
}
```

---

## Test Case 5: ทดสอบบริบททางวัฒนธรรมไทย

### สิ่งที่ต้องตรวจสอบ (Checklist)
- [ ] ใช้หลักธรรมพุทธศาสนา (กรรม, อนิจจัง, สติปัญญา, ทางสายกลาง, เมตตา)
- [ ] น้ำเสียงอบอุ่น เป็นกันเอง ไม่ตัดสิน
- [ ] ให้ทั้งความหวังและความจริง (ไม่รับประกัน 100%)
- [ ] เคารพเสรีภาพในการตัดสินใจ

### ตัวอย่างที่ถูกต้อง
```
"แม้ตอนนี้สถานการณ์ยาก แต่ถ้าคุณใช้สติและวางแผนอย่างรอบคอบ มีโอกาสสูงที่จะเห็นการเปลี่ยนแปลงในทางบวก 
อย่างไรก็ตาม ผลลัพธ์ขึ้นอยู่กับการกระทำของคุณเป็นหลัก"
```

---

## Test Case 6: ทดสอบสัญลักษณ์และอาร์คีไทป์

### สิ่งที่ต้องตรวจสอบ (Checklist)
- [ ] อ้างอิงสัญลักษณ์ในไพ่ (สี, ตัวเลข, สัตว์, ธาตุ)
- [ ] เชื่อมโยงกับความหมายดั้งเดิม (archetypal meanings)
- [ ] ใช้ภาพพจน์ที่เข้าใจง่าย

### ตัวอย่างที่ถูกต้อง
```
"ดาบในไพ่นี้แทนความคิดที่คมกริบ แต่ถ้าใช้มากเกินไปอาจทำร้ายตัวเอง เหมือนดาบสองคม 
สีเหลืองในพื้นหลังแทนพลังงานทางปัญญาที่กำลังสว่างไสว"
```

---

## Test Case 7: ทดสอบ Validation

### วิธีทดสอบ
ดู Console หรือ Network tab ใน DevTools

### สิ่งที่ต้องตรวจสอบ (Checklist)
- [ ] ไม่มี validation error เกี่ยวกับ "summary_too_short"
- [ ] ไม่มี validation error เกี่ยวกับ "cardstructure_too_short"
- [ ] ไม่มี warning เกี่ยวกับ "lack depth"

---

## วิธีการทดสอบแบบเต็ม

### 1. ทดสอบผ่าน UI
```bash
# Start dev server
cd C:\Users\Administrator\CascadeProjects\mysticflow\web
npm run dev
```

1. เปิด http://localhost:3000/tarot
2. เลือก 3-Card Spread
3. เลือกไพ่ 3 ใบ
4. ใส่คำถาม: "งานของฉันจะเป็นอย่างไรในอีก 3 เดือนข้างหน้า"
5. กด Submit
6. เปิด DevTools → Network → ดู response จาก `/api/ai/tarot`

### 2. ทดสอบผ่าน API โดยตรง
```bash
# ใช้ curl หรือ Postman
curl -X POST http://localhost:3000/api/ai/tarot \
  -H "Content-Type: application/json" \
  -d '{
    "cards": [
      {"id": "major-00", "orientation": "upright"},
      {"id": "major-01", "orientation": "upright"},
      {"id": "major-02", "orientation": "reversed"}
    ],
    "count": 3,
    "question": "งานของฉันจะเป็นอย่างไรในอีก 3 เดือนข้างหน้า"
  }'
```

### 3. ตรวจสอบ Response
ดูว่า response มีโครงสร้างแบบนี้:
```json
{
  "ok": true,
  "ai": {
    "summary": "สรุปยาว 3-5 บรรทัด...",
    "cards": [
      {
        "position": "อดีต",
        "card": "The Fool",
        "keywords": ["เริ่มต้นใหม่", "ผจญภัย", "ความไร้เดียงสา"],
        "meaning": "ความหมายยาว 3-4 ประโยค...",
        "psychologicalLayer": "มิติทางจิตวิทยา...",
        "energyPattern": "รูปแบบพลังงาน..."
      }
    ],
    "opportunities": ["โอกาส 1 พร้อมรายละเอียด", "โอกาส 2", "โอกาส 3"],
    "risks": ["ความเสี่ยง 1 พร้อมวิธีรับมือ", "ความเสี่ยง 2", "ความเสี่ยง 3"],
    "actions": [
      "ขั้นตอนที่ 1: ทันที (1-3 วัน)...",
      "ขั้นตอนที่ 2: ระยะสั้น (1-2 สัปดาห์)...",
      "ขั้นตอนที่ 3: ระยะยาว (นิสัย)..."
    ],
    "deeperInsight": "ข้อคิดเชิงลึก 2-3 ประโยค...",
    "timeframe": "กรอบเวลาเฉพาะเจาะจง...",
    "confidence": "med",
    "disclaimer": "คำเตือนมาตรฐาน"
  }
}
```

---

## เกณฑ์การผ่านการทดสอบ

### ✅ ผ่าน (PASS)
- Summary ยาว 3-5 บรรทัด ครอบคลุมธีมหลัก
- CardStructure มากกว่า 300 ตัวอักษรไทย
- มีฟิลด์ `psychologicalLayer` และ `energyPattern`
- มีฟิลด์ `deeperInsight` ที่มีความหมาย
- `actions` มี 3 ขั้นตอนพร้อมกรอบเวลา
- ใช้หลักธรรมพุทธศาสนาและน้ำเสียงไทย
- ไม่มี validation errors

### ❌ ไม่ผ่าน (FAIL)
- Summary สั้นเกินไป (< 2 บรรทัด)
- CardStructure สั้นเกินไป (< 300 ตัวอักษร)
- ไม่มีฟิลด์ใหม่ (psychologicalLayer, energyPattern, deeperInsight)
- คำแนะนำคลุมเครือ ไม่มีขั้นตอนชัดเจน
- มี validation errors ใน console

---

## ผลการทดสอบ

### วันที่: _______________
### ผู้ทดสอบ: _______________

| Test Case | ผ่าน/ไม่ผ่าน | หมายเหตุ |
|-----------|-------------|----------|
| 1. ความยาวและความครบถ้วน | ⬜ PASS ⬜ FAIL | |
| 2. มิติทางจิตวิทยาและพลังงาน | ⬜ PASS ⬜ FAIL | |
| 3. ข้อคิดเชิงลึก | ⬜ PASS ⬜ FAIL | |
| 4. คำแนะนำที่ปฏิบัติได้ | ⬜ PASS ⬜ FAIL | |
| 5. บริบททางวัฒนธรรมไทย | ⬜ PASS ⬜ FAIL | |
| 6. สัญลักษณ์และอาร์คีไทป์ | ⬜ PASS ⬜ FAIL | |
| 7. Validation | ⬜ PASS ⬜ FAIL | |

### สรุปผลการทดสอบ
⬜ **ผ่านทั้งหมด** - AI ใช้แหล่งข้อมูลใหม่แล้ว  
⬜ **ผ่านบางส่วน** - ต้องตรวจสอบเพิ่มเติม  
⬜ **ไม่ผ่าน** - AI ยังไม่ได้ใช้แหล่งข้อมูลใหม่

### ข้อสังเกตเพิ่มเติม:
```
(เขียนข้อสังเกตที่นี่)
```
